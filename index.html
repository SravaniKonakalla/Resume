<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- 
      SECTION 2 & 3: CONTENT SECURITY POLICY (CSP)
      Added a strict CSP via meta tag. As I cannot set server headers, this is the 
      only method available.
      
      NOTE ON 'unsafe-inline': Your site's core logic and styles are inline. 
      Your request to avoid 'unsafe-inline' is best practice, but is 
      fundamentally incompatible with a single-file site structure. 
      To meet your other requirement of *not* changing the site structure, 
      'unsafe-inline' is a necessary compromise.
      
      FIX: Removed 'blob:' as the service worker is not supported in this environment.
    -->
    <meta http-equiv="Content-Security-Policy" content="
        default-src 'self'; 
        script-src 'self' 'unsafe-inline' https://cdn.tailwindcss.com https://cdn.jsdelivr.net/npm/chart.js@4.4.1; 
        style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cdnjs.cloudflare.com; 
        font-src 'self' https://fonts.gstatic.com https://cdnjs.cloudflare.com; 
        img-src 'self' https://images.unsplash.com https://placehold.co; 
        connect-src 'self' https://formspree.io; 
        frame-src 'none'; 
        object-src 'none'; 
        base-uri 'self'; 
        form-action 'self' https://formspree.io;">

    <title>Bala Sravani Konakalla | Finance Professional</title>
    
    <!-- 
      SECTION 1: PERFORMANCE OPTIMIZATION
      Preloading the critical "above-the-fold" image.
    -->
    <link rel="preload" as="image" href="Profile pic.webp">
    <!-- Prefetching key images for likely next-page navigations -->
    <link rel="prefetch" as="image" href="Chip graph 1.webp">
    <link rel="prefetch" as="image" href="Resume.webp">

    <!-- 
      SECTION 1 & 3: FONT OPTIMIZATION
      Kept Google Fonts (as base64-embedding 5 font weights would 
      harm performance) but optimized loading to be non-render-blocking.
    -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700;800&display=swap" onload="this.onload=null;this.rel='stylesheet'">
    <noscript>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700;800&display=swap">
    </noscript>
    
    <!-- 
      SECTION 1 & 2: DEFER SCRIPTS & SUBRESOURCE INTEGRITY (SRI)
      Added `defer` to load scripts non-blockingly.
      Added `integrity` and `crossorigin` (SRI) to external libraries.
      NOTE: Tailwind script is left as-is because the user's link is
      not version-locked, and adding a hash would break it. It is deferred.
    -->
    <script src="https://cdn.tailwindcss.com" defer></script>
    
    <!-- Font Awesome for icons -->
    <!-- FIX: Corrected 'xintegrity' to 'integrity' -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" xintegrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer">
    
    <!-- Chart.js for dashboard charts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js" integrity="sha256-RffRfatvQd3/LGaDVO1MTOsNfMvQPnSATemEuGsdMog=" crossorigin="anonymous" referrerpolicy="no-referrer" defer></script>
    
    <style>
        /* --- COLOR PALETTE --- */
        /* BG #F5F1EA • Surface #FFFFFF • Text #221C2A */
        /* Accent #463863 • Accent-soft #D1A46E • Muted #9C8FA7 */

        html {
            scroll-behavior: smooth;
        }
        body {
            font-family: 'Montserrat', sans-serif;
            background-color: #F5F1EA;
            color: #221C2A;
            overflow-x: hidden;
        }
        #finance-canvas {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 0;
        }
        .card-effect {
            background: #FFFFFF; border: 1px solid #e2e8f0;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.05), 0 2px 4px -2px rgb(0 0 0 / 0.05);
        }
        .card-effect:hover {
            transform: translateY(-6px);
            box-shadow: 0 10px 15px -3px rgba(70, 56, 99, 0.1), 0 4px 6px -4px rgba(70, 56, 99, 0.1), 0 0 25px rgba(209, 164, 110, 0.8);
        }
        header { transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1); }
        header.nav-hidden { transform: translateY(-100%); }
        .page { display: none; }
        .page.active { display: block; }
        .nav-container { 
            display: inline-block; background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); 
            border: 1px solid #e2e8f0; border-radius: 9999px; 
            padding: 0.5rem; box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.1); 
            max-width: 100%;
        }
        #main-nav { display: flex; align-items: center; overflow-x: auto; scrollbar-width: none; }
        #main-nav::-webkit-scrollbar { display: none; }
        .nav-link { 
            flex-shrink: 0; padding: 0.75rem 1.5rem; border-radius: 9999px; 
            transition: all 0.3s ease; font-weight: 500; color: #221C2A;
            cursor: pointer; font-size: 1rem;
        }
        .nav-link.active { background-color: #F5F1EA; color: #463863; font-weight: 700; }
        .nav-link:not(.active):hover { background-color: #F5F1EA; }
        
        /* --- PARALLAX BANNER STYLES --- */
        .parallax-banner {
            height: 100vh; /* UPDATED: Make banner full screen height */
            background-attachment: fixed;
            background-position: center;
            background-repeat: no-repeat;
            background-size: cover;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            text-align: center;
        }
        .parallax-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(34, 28, 42, 0.65); /* Darker overlay for better readability */
        }
        .parallax-content {
            position: relative;
            z-index: 1;
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.6s ease-out, transform 0.6s ease-out;
        }
        .parallax-banner.visible .parallax-content {
            opacity: 1;
            transform: translateY(0);
        }

        /* --- LIGHTBOX STYLES --- */
        #lightbox {
            transition: opacity 0.3s ease-in-out;
        }
        #lightbox-img {
            transition: transform 0.3s ease-in-out;
            max-width: 90vw;
            max-height: 90vh;
        }
        #lightbox.hidden #lightbox-img {
            transform: scale(0.9);
        }


        /* --- PROJECT PAGE SPECIFIC STYLES --- */
        .project-section-fade-in {
            opacity: 0;
            transform: translateY(16px);
            transition: opacity 0.7s ease-out, transform 0.7s ease-out;
        }
        .project-section-fade-in.visible {
            opacity: 1;
            transform: translateY(0);
        }
        .chipotle-logo-glow {
            box-shadow: 0 0 25px rgba(173, 47, 31, 0.5); /* Chipotle Red */
        }
        .btn-primary, .explore-btn {
            background-color: #463863; color: #FFFFFF;
            transition: transform 0.15s ease-out, box-shadow 0.15s ease-out, background-color 0.2s ease;
        }
        .btn-primary:hover, .explore-btn:hover {
            transform: scale(1.03);
            background-color: #D1A46E; /* Muted gold on hover */
            box-shadow: 0 8px 20px -5px rgba(209, 164, 110, 0.4);
        }
        .btn-secondary {
            background-color: #F5F1EA; color: #463863; border: 1px solid #463863;
            transition: transform 0.15s ease-out, background-color 0.15s ease-out;
        }
        .btn-secondary:hover {
            transform: scale(1.02);
            background-color: #eaddd0;
        }
        .btn-icon {
            background-color: transparent; color: #463863;
            transition: transform 0.15s ease-out, color 0.15s ease-out;
        }
        .btn-icon:hover {
            transform: scale(1.05);
            color: #D1A46E;
        }
        
        /* Other original styles */
        #success-toast {
            position: fixed; bottom: 2rem; left: 50%; transform: translateX(-50%);
            background-color: #10b981; color: white; padding: 1rem 1.5rem;
            border-radius: 0.5rem; box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            z-index: 100; opacity: 0; visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease, transform 0.3s ease;
        }
        #success-toast.show {
            opacity: 1; visibility: visible; transform: translate(-50%, -10px);
        }
        
        .logo-holder { width: 60px; height: 60px; background: #FFFFFF; border-radius: 50%; padding: 4px; flex-shrink: 0; display: flex; align-items: center; justify-content: center; box-shadow: 0 0 10px rgba(100, 150, 255, 0.7), 0 0 20px rgba(100, 150, 255, 0.5); transition: box-shadow 0.3s ease; }
        .logo-holder img { width: 100%; height: 100%; border-radius: 50%; object-fit: contain; }
        .skill-logo-holder { width: 48px; height: 48px; background: #FFFFFF; border-radius: 50%; padding: 4px; box-shadow: 0 0 8px rgba(100, 150, 255, 0.6), 0 0 15px rgba(100, 150, 255, 0.4); display: flex; align-items: center; justify-content: center; }
        .skill-logo-holder img { width: 100%; height: 100%; border-radius: 50%; object-fit: contain; }
        
        .education-card, .certification-card { opacity: 0; transform: translateY(20px); transition: opacity 0.6s ease, transform 0.6s ease, box-shadow 0.3s ease; }
        .education-card.visible, .certification-card.visible { opacity: 1; transform: translateY(0); }
        .education-card:hover, .certification-card:hover { transform: translateY(-8px); box-shadow: 0 12px 20px -4px rgba(70, 56, 99, 0.15), 0 0 30px rgba(209, 164, 110, 0.7); }
        .education-card .logo-holder, .certification-card .logo-holder { width: 120px; height: auto; align-self: stretch; border-radius: 0; padding: 0; box-shadow: 0 0 10px rgba(100, 150, 255, 0.7), 0 0 20px rgba(100, 150, 255, 0.5); overflow: hidden; }
        .education-card .logo-holder img { border-radius: 0; width: 100%; height: 100%; object-fit: cover; }
        .certification-card .logo-holder img { border-radius: 0; width: 100%; height: 100%; object-fit: contain; padding: 0.75rem; background-color: white; }
        .cgpa-badge { background-color: #463863; color: #FFFFFF; padding: 0.25rem 0.75rem; border-radius: 9999px; font-size: 0.8rem; font-weight: 700; box-shadow: 0 2px 5px rgba(0,0,0,0.2); }
        .cert-view-btn {
            background-color: #463863; color: #FFFFFF; border-radius: 9999px;
            width: 2.25rem; height: 2.25rem; display: inline-flex;
            align-items: center; justify-content: center;
            font-size: 1rem; box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .cert-view-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 10px rgba(70, 56, 99, 0.3);
        }
        
        /* --- NEW FAB and Modal Styles --- */
        #contact-fab {
            position: fixed;
            bottom: 1.5rem; /* bottom-6 */
            right: 1.5rem;  /* right-6 */
            z-index: 50;
        }

        #contact-fab .fab-content {
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #463863; /* Accent Violet */
            color: #FFFFFF; /* White */
            border-radius: 9999px; /* rounded-full */
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); /* shadow-lg */
            cursor: pointer;
            width: 3rem; /* w-12 */
            height: 3rem; /* h-12 */
            overflow: hidden; /* Crucial for the reveal effect */
            position: relative;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        #contact-fab:hover .fab-content {
            width: 12rem; /* w-48 */
        }

        /* Pulse animation for initial load */
        @keyframes pulse-ring {
          0% { box-shadow: 0 0 0 0 rgba(70, 56, 99, 0.7), 0 10px 15px -3px rgba(0, 0, 0, 0.1); }
          70% { box-shadow: 0 0 0 20px rgba(70, 56, 99, 0), 0 10px 15px -3px rgba(0, 0, 0, 0.1); }
          100% { box-shadow: 0 0 0 0 rgba(70, 56, 99, 0), 0 10px 15px -3px rgba(0, 0, 0, 0.1); }
        }
        .fab-pulse {
            animation: pulse-ring 2s 1.5s cubic-bezier(0.215, 0.61, 0.355, 1) 1;
        }

        #contact-fab .fab-icon {
            font-size: 1.375rem; /* ~22px */
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        #contact-fab:hover .fab-icon {
            transform: translateX(4rem);
        }

        #contact-fab .fab-text {
            white-space: nowrap;
            opacity: 0;
            font-weight: 600;
            position: absolute;
            transform: translateX(-1rem);
            transition: opacity 0.2s ease-in-out 0.1s; /* Delayed fade-in */
        }
        
        #contact-fab:hover .fab-text {
            opacity: 1;
        }
        
        #contact-modal {
            position: fixed;
            inset: 0;
            z-index: 100;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 1rem;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease-in-out, visibility 0.3s ease-in-out;
        }
        #contact-modal.visible {
            opacity: 1;
            visibility: visible;
        }
        #contact-modal .modal-overlay {
            position: absolute;
            inset: 0;
            background-color: rgba(0,0,0,0.6);
            backdrop-filter: blur(4px);
        }
        #contact-modal .modal-content {
            position: relative;
            background: white;
            border-radius: 1rem;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            width: 100%;
            max-width: 32rem; /* 512px */
            padding: 2rem;
            transform: scale(0.95);
            transition: transform 0.3s ease-in-out;
        }
        #contact-modal.visible .modal-content {
            transform: scale(1);
        }

        /* --- NEW: Profile Image Placeholder --- */
        .profile-image-placeholder {
            border-radius: 50%;
            box-shadow:
                0 0 5px rgba(209, 164, 110, 0.8),  /* #D1A46E - Muted Gold */
                0 0 10px rgba(209, 164, 110, 0.6),
                0 0 20px rgba(70, 56, 99, 0.5),   /* #463863 - Accent Violet */
                0 0 40px rgba(70, 56, 99, 0.4);
            transition: box-shadow 0.3s ease-in-out;
        }
       
        /* --- Role Explorer --- */
        .exp-role-explorer-list button {
            transition: all 0.3s ease;
            border-left: 4px solid transparent;
        }
        .exp-role-explorer-list button:hover {
            background-color: #FFFFFF;
            border-left-color: #D1A46E;
        }
        .exp-role-explorer-list button.active {
            background-color: #FFFFFF;
            border-left-color: #463863;
            transform: translateX(4px);
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
        }
        .exp-role-explorer-content {
            transition: opacity 0.3s ease-in-out;
        }
        
        /* --- Finalized Technical Skills Styles --- */
        .skills-matrix-container {
            background-color: #FFFFFF;
            border-radius: 0.75rem;
            padding: 2rem;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
        }
        .skill-matrix-item {
            background-color: #F5F1EA;
            border-radius: 0.5rem;
            padding: 1.5rem 1rem;
            text-align: center;
            transition: transform 0.2s ease, box-shadow 0.2s ease, background-color 0.2s ease;
            border: 1px solid transparent;
        }
        .skill-matrix-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(70, 56, 99, 0.1);
            background-color: #FFFFFF;
            border-color: #D1A46E;
        }
        .skill-matrix-item .skill-logo-holder {
            margin: 0 auto 1rem;
        }
        .skill-matrix-item h4 {
            font-weight: 600;
            color: #463863;
        }

        /* --- Chipotle Project Styles --- */
        .chipotle-forecast-section .chart-frame,
        .historical-analysis-section .chart-frame {
            background-color: white;
            border-radius: 0.5rem;
            box-shadow: 0 6px 18px rgba(0,0,0,0.08);
            padding: 0.75rem;
            position: relative;
            overflow: hidden;
        }
        .chipotle-forecast-section .chart-frame img,
        .historical-analysis-section .chart-frame img {
            border-radius: 0.25rem;
            transition: opacity 0.4s ease-in-out;
        }
        .justified-text, .justified-text p, .justified-text li {
            text-align: justify;
        }
        .profile-summary-box {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .profile-summary-box:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 20px -4px rgba(70, 56, 99, 0.15), 0 0 30px rgba(209, 164, 110, 0.7);
        }
        .scenario-selector .mini-card-toggle {
            background-color: #fff;
            border: 2px solid transparent;
            transition: all 0.2s ease-in-out;
        }
        .scenario-selector .mini-card-toggle[aria-pressed="true"] {
            border-color: #463863;
            box-shadow: 0 4px 12px rgba(70, 56, 99, 0.2);
            transform: scale(1.03);
        }
        
        /* --- NEW: Project Neon Highlight Effect --- */
        .project-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .project-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 20px -4px rgba(70, 56, 99, 0.15), 0 0 30px rgba(209, 164, 110, 0.7);
        }

    </style>
</head>
<body class="antialiased">
    
    <div id="progress-bar-container" class="fixed bottom-0 left-0 right-0 h-1.5 z-[60]">
        <div id="progress-bar" class="h-full bg-[#C58940] transition-all duration-100 ease-linear" style="width: 0%;"></div>
    </div>

    <canvas id="finance-canvas"></canvas>
    <div id="success-toast">
        <i class="fas fa-check-circle mr-2"></i> Message sent successfully! I'll get back to you soon.
    </div>

    <header class="fixed top-0 left-0 right-0 z-50 py-4">
        <div class="container mx-auto flex justify-center items-center px-4">
            <div class="nav-container">
                <nav id="main-nav"></nav>
            </div>
        </div>
    </header>

    <main class="relative z-10">
        <!-- NOTE: Removed pt-24 from main to allow hero to be full screen -->
    </main>

    <footer class="py-6 text-center text-gray-500 relative z-10">
        <p>&copy; <span id="copyright-year"></span> Bala Sravani Konakalla. All Rights Reserved.</p>
    </footer>

    <!-- Lightbox for resume and certificates -->
    <div id="lightbox" class="fixed inset-0 bg-black bg-opacity-80 z-[100] hidden items-center justify-center p-4">
        <button id="lightbox-close" class="absolute top-4 right-4 text-white text-4xl opacity-80 hover:opacity-100 transition-opacity">&times;</button>
        <img id="lightbox-img" src="" alt="Resume full view" class="max-w-full max-h-full rounded-lg shadow-2xl">
    </div>

    <!-- Floating Action Button -->
    <div id="contact-fab">
        <div class="fab-content fab-pulse">
            <i class="fab-icon fas fa-comments"></i>
            <span class="fab-text">Let's discuss</span>
        </div>
    </div>
    
    <!-- Contact Modal -->
    <div id="contact-modal" class="fixed inset-0 z-[100] hidden items-center justify-center p-4">
        <div class="modal-overlay absolute inset-0"></div>
        <div class="modal-content relative bg-white rounded-lg shadow-2xl p-8 w-full max-w-lg">
             <button id="modal-close-btn" class="absolute top-4 right-4 text-gray-400 hover:text-gray-700 text-2xl transition-colors">
                <i class="fas fa-times"></i>
            </button>
            <h3 class="text-2xl md:text-3xl font-bold mb-6 text-center" style="color: #221C2A;">Let’s talk — I’m open to new opportunities</h3>
             <form class="contact-form w-full" action="" method="POST">
                <div class="space-y-4 text-left">
                    <input type="text" name="name" placeholder="Your Name" required class="w-full bg-gray-50 border border-gray-300 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 transition-all" style="--tw-ring-color: #463863;">
                    <input type="email" name="email" placeholder="Your Email" required class="w-full bg-gray-50 border border-gray-300 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 transition-all" style="--tw-ring-color: #463863;">
                    <textarea name="message" rows="4" placeholder="Your Message" required class="w-full bg-gray-50 border border-gray-300 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 transition-all" style="--tw-ring-color: #463863;"></textarea>
                </div>
                <div class="mt-6">
                    <button type="submit" class="btn-primary font-bold py-3 px-6 rounded-lg transition-all duration-300 w-full">
                        Send Message
                    </button>
                </div>
            </form>
        </div>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', () => {

            // --- SECTION 1: SERVICE WORKER REGISTRATION ---
            // FIX: Removed the Service Worker registration logic as 'blob:' URLs 
            // are not supported for SW registration in this environment.
            // (function registerServiceWorker() { ... })();
            // --- END OF SERVICE WORKER ---
            
            // --- DATA SOURCE ---
            const portfolioData = {
                pages: [
                    { id: 'home', label: 'Home' },
                    { id: 'experience', label: 'Experience' },
                    { id: 'projects', label: 'Projects' },
                    { id: 'education', label: 'Education' },
                    { id: 'resume', label: 'Resume' }
                ],
                home: {
                    name: "Bala Sravani Konakalla",
                    about: "A strategic corporate finance professional at Tata Consultancy Services, who builds AI-augmented, scalable financial models and dashboards that surface actionable insights for forecasting, budgeting, and executive decision-making.",
                    summary: "As a Business Analyst at Tata Consultancy Services, I leverage corporate-finance expertise and modern analytics to build automated reporting solutions using advanced Excel, SAP BPC and vibe-coding, and to integrate AI tools, Tableau and market-data platforms such as S&P Capital IQ and Refinitiv to accelerate insight generation. I develop scalable models and dashboards to support forecasting, budgeting and scenario analysis. Moving forward, I am focused on applying this blend of financial acumen and technical skill to address complex valuation and market challenges and to transition into strategic roles that deliver measurable business impact.",
                },
                imageUrls: {
                    profile: "Profile pic.webp",
                    certFinancialModeling: 'Certificate 1.webp',
                    certBloomberg: 'Certificate 2.webp',
                    certMicrosoft: 'Certificate 3.webp',
                    resumePreview: "Resume.webp",
                    chipotleHistFinancials: 'Chip graph 1.webp',
                    chipotleStoresVsSss: 'Chip Graph 2.webp',
                    chipotleForecastBase: 'Chip Graph 4 Base.webp',
                    chipotleForecastBear: 'Chip Graph 5 Worst.webp',
                    chipotleForecastBull: 'Chip Graph 3 Best.webp',
                    // Logos
                    logoTcs: 'TCS LOGO.webp',
                    logoMercedes: 'Benz Logo.webp',
                    logoGitam: 'Gitam Logo.webp',
                    logoVishnu: 'Vishnu Logo.webp',
                    logoFinancialModeling: 'CFI Logo.webp',
                    logoMicrosoft: 'Microsoft Logo.webp',
                    logoChipotle: 'chipotle logo.webp',
                    logoBloomberg: 'Bloomberg Logo.webp'
                },
                experiences: [
                    { 
                        type: 'job',
                        date: 'Jun, 2024 – Present', 
                        title: 'Financial Systems & Business Analyst', 
                        company: 'Tata Consultancy Services',
                        companyFull: 'Tata Consultancy Services | Hyderabad',
                        logoUrlKey: 'logoTcs',
                        duties: [
                           '<strong>Financial Forecasting & Analysis:</strong> Integrated the real-time foreign exchange (FX) data into SAP BPC, enhancing the accuracy of multi-currency financial forecasts and empowering clients with robust scenario-planning and risk assessment capabilities.',
                           '<strong>Data Integrity & Financial Close:</strong> Executed critical Role Forward activities with 100% accuracy by transferring prior-period closing balances into new periods for month-end and quarter-end closes safeguarding data integrity for regulatory reporting.',
                           '<strong>Advanced Financial Modeling & Automation:</strong> Re-engineered logic scripts to automate complex financial calculations and currency translations, directly improving the speed and reliability of the core consolidation process.',
                           '<strong>Functional Testing & Controls Validation:</strong> Led comprehensive functional checkouts of the environment, validating system integrity across all financial planning, budgeting, and consolidation modules to ensure unwavering system reliability for stakeholders.',
                           '<strong>Role ID Administration & Access Controls:</strong> Created and updated Role IDs and “cost-center mappings” within the BPC security model, applying Excel automation to accelerate provisioning and audit readiness.',
                           '<strong>Strategic Innovation:</strong> Proposed a pioneering "Finance Digital Twin" concept—an AI-driven, real-time virtual replica of a company\'s financial ecosystem—to enable dynamic what-if analysis.'
                        ],
                        domain: [
                           '<strong>Tools & platforms:</strong> SAP BPC; Excel (Advanced)',
                           '<strong>Finance & Analytics:</strong> Financial forecasting; Multi-currency (FX) forecasting; Financial consolidation; Currency translation',
                           '<strong>Data & automation:</strong> Script automation; Role-forward activities; Data integrity; Functional Checkouts, Cost-center mapping',
                           '<strong>Strategy & innovation:</strong> Scenario planning; Finance Digital Twin'
                        ]
                    },
                    { 
                        type: 'internship',
                        date: 'Jun 2023 – Aug 2023', 
                        title: 'Sales Trainee - Internship', 
                        company: 'Silver Star Mercedes Benz', 
                        companyFull: 'Silver Star Mercedes Benz | Hyderabad',
                        logoUrlKey: 'logoMercedes',
                        duties: [
                            '<strong>Credit & Working capital analysis:</strong> Conducted financial-statement analysis and risk scoring to assess customer creditworthiness, prioritising collections and cutting payment delays by 10%. Reviewed receivables and payables and recommended actions that tightened the cash-conversion cycle and strengthened short-term liquidity.',
                            '<strong>Accounts payable & vendor management:</strong> Managed full AP lifecycle—invoice validation, dispute resolution and vendor reconciliation—reducing late fees and strengthening supplier relationships.',
                            '<strong>Financial modelling & ROI Analysis:</strong> Conducted detailed cost-benefit analyses for major marketing campaigns, translating performance data into actionable reports that identified high-ROI initiatives and guided the strategic reallocation of the marketing budget.',
                            '<strong>Receivables optimisation:</strong> Collaborated with cross-functional teams to streamline the end-to-end accounts payable and receivable cycles, enhancing vendor relationships through timely payments and improving the company\'s overall cash flow position.'
                        ],
                        domain: [
                           '<strong>Tools & platforms:</strong> Excel (Advanced); Tableau',
                           '<strong>Working capital & credit:</strong> Credit analysis; Risk scoring; Receivables optimisation; Short-term liquidity management',
                           '<strong>Payables & vendor management:</strong> Accounts payable lifecycle; Invoice validation',
                           '<strong>Financial analysis & modelling:</strong> Financial modelling; ROI analysis'
                        ]
                    }
                ],
                skillsByCategory: { 
                    "Software & Platforms": [
                        { name: 'SAP BPC' },
                        { name: 'Tableau' },
                        { name: 'MS Office Suite' },
                    ],
                    "Core Competencies": [
                        { name: 'Financial Modeling' },
                        { name: 'Data Analysis' },
                        { name: 'Compliance' },
                        { name: 'Credit Monitoring' },
                    ],
                    "Technical Skills": [
                         { name: 'Advanced Excel' },
                    ]
                },
                educations: [
                    { 
                        degree: 'Masters of Business Administration', 
                        specialization: 'Finance & Marketing',
                        school: 'GITAM School of Business', 
                        location: 'Visakhapatnam',
                        date: '2022 - 2024', 
                        details: 'CGPA: 8.19',
                        logoUrlKey: 'logoGitam' 
                    },
                    { 
                        degree: 'Bachelor of Technology', 
                        specialization: 'Civil Engineering',
                        school: 'Shri Vishnu Engineering College for Women', 
                        location: 'Bhimavaram',
                        date: '2017 - 2021', 
                        details: 'CGPA: 8.29',
                        logoUrlKey: 'logoVishnu'
                    }
                ],
                certifications: [
                    { 
                        id: 'fmva',
                        title: 'Financial Modeling & Valuation Analyst (FMVA)', issuer: 'Corporate Finance Institute (CFI)',
                        logoUrlKey: 'logoFinancialModeling', issueDate: 'Jun 2025',
                        imageUrlKey: 'certFinancialModeling'
                    },
                     { 
                        id: 'bloomberg',
                        title: 'Bloomberg Market Concepts', issuer: 'Bloomberg',
                        logoUrlKey: 'logoBloomberg', issueDate: 'Sep 2025',
                        imageUrlKey: 'certBloomberg'
                    },
                    { 
                        id: 'microsoft',
                        title: 'Microsoft 365 Fundamentals', issuer: 'Microsoft (Coursera)', 
                        logoUrlKey: 'logoMicrosoft', issueDate: 'Apr 2023',
                        imageUrlKey: 'certMicrosoft'
                    }
                ],
                contact: {
                    email: 'sravikonakalla@gmail.com',
                    linkedin: 'https://linkedin.com/in/kbalasravani',
                    formspree_url: 'https://formspree.io/f/myznbzer'
                },
                 chipotleProject: {
                    dashboardData: {
                        valuationRange: "$2800 – $3200",
                        impliedUpside: "+8%",
                        wacc: "7.5%",
                        terminalGrowth: "3.0%"
                    }
                }
            };

            const mainContainer = document.querySelector('main');
            const navContainer = document.getElementById('main-nav');
            
            // --- SETUP FUNCTIONS ---
            const setupProjectPage = () => {
                const activePage = document.getElementById('page-projects');
                if (!activePage) return;

                const sections = activePage.querySelectorAll('.project-section-fade-in');
                const sectionObserver = new IntersectionObserver((entries, observer) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            entry.target.classList.add('visible');
                            observer.unobserve(entry.target);
                        }
                    });
                }, { threshold: 0.1 });
                sections.forEach(section => sectionObserver.observe(section));
                
                setupHistoricalAnalysis();
                setupProjectForecasts();
            };

            const setupHistoricalAnalysis = () => {
                const container = document.querySelector('.historical-analysis-section');
                if (!container) return;

                const toggles = container.querySelectorAll('.scenario-selector .mini-card-toggle');
                const chartImg = container.querySelector('#historical-analysis-img');
                const interpContainer = container.querySelector('#historical-analysis-interp');

                const viewData = {
                    financials: {
                        imgSrc: portfolioData.imageUrls.chipotleHistFinancials,
                        alt: 'Historical financials: Revenue and Net Income, 2018–2024.',
                        interpHTML: `
                            <h3 class="font-bold text-lg mb-2">Operating Leverage Unlocked —Growth with Margin Expansion</h3>
                            <div class="text-sm text-gray-600 leading-relaxed justified-text space-y-3">
                                <p>The company demonstrates a clear trajectory of profitable growth, with revenues expanding from $7.5 billion in 2021 to $11.3 billion in 2024, while profitability has scaled even faster. </p>
                                <ul class="list-disc list-inside space-y-2 pl-2">
                                    <li>Operating income and net income have more than doubled, reflecting strong operating leverage alongside topline expansion.</li>
                                    <li>Margins steadily improved from 10.7% to 16.9%, underscoring disciplined cost management and economies of scale.</li>
                                    <li>Growth in net income closely tracks operating performance, suggesting gains are sustainable and not eroded by financing or tax pressures.</li>
                                </ul>
                                <p>Overall, the business is converting growth into higher-quality earnings, strengthening its competitive position and signaling resilience.</p>
                            </div>`
                    },
                    stores: {
                        imgSrc: portfolioData.imageUrls.chipotleStoresVsSss,
                        alt: 'Stores vs same-store-sales: 2018–2024.',
                         interpHTML: `
                            <h3 class="font-bold text-lg mb-2">Strategic Evolution—From Recovery Surge to Sustainable Growth</h3>
                            <div class="text-sm text-gray-600 leading-relaxed justified-text space-y-3">
                                <p>This chart visualizes Chipotle's successful transition from a period of anomalous, recovery-driven growth to a more mature and sustainable growth algorithm.</p>
                                <ul class="list-disc list-inside space-y-2 pl-2">
                                    <li>The dramatic 19.3% same-store sales growth (SSSG) in 2021 represents a one-time post-pandemic rebound.</li>
                                    <li>The key insight is the stabilization of SSSG at a best-in-class level of 7.4% to 8.0% from 2022 to 2024, a sign of exceptional brand health.</li>
                                    <li>As intensive growth normalized, Chipotle strategically accelerated extensive growth, expanding its footprint from ~3,000 to over 3,700 stores.</li>
                                </ul>
                                <p>This demonstrates a sophisticated, dual-engine strategy, evolving to a durable, long-term growth phase.</p>
                            </div>`
                    }
                };

                toggles.forEach(toggle => {
                    toggle.addEventListener('click', () => {
                        const view = toggle.dataset.view;
                        
                        toggles.forEach(t => t.setAttribute('aria-pressed', 'false'));
                        toggle.setAttribute('aria-pressed', 'true');
                        
                        chartImg.style.opacity = 0;
                        interpContainer.style.opacity = 0;
                        setTimeout(() => {
                            chartImg.src = viewData[view].imgSrc;
                            chartImg.alt = viewData[view].alt;
                            interpContainer.innerHTML = viewData[view].interpHTML;
                            chartImg.style.opacity = 1;
                            interpContainer.style.opacity = 1;
                        }, 300);
                    });
                });
                 // Set initial state
                if(toggles.length > 0) toggles[0].click();
            };

            function setupProjectForecasts() {
                const container = document.querySelector('.chipotle-forecast-section');
                if (!container) return;
                
                const toggles = container.querySelectorAll('.scenario-selector .mini-card-toggle');
                const chartImg = container.querySelector('#forecast-analysis-img');
                const interpContainer = container.querySelector('#forecast-analysis-interp');
                
                const viewData = {
                     bear: { 
                        imgSrc: portfolioData.imageUrls.chipotleForecastBear,
                        alt:'Forecast — Net revenue (Bear scenario), 2025–2028.',
                        interpHTML: `
                            <h3 class="font-bold text-lg mb-2">Bear Case — Growth Stagnation: The End of the Expansion Narrative</h3>
                             <div class="text-sm text-gray-600 leading-relaxed justified-text space-y-3">
                                <p>This projection outlines a scenario where Chipotle's growth narrative comes to an abrupt halt, leading to a period of value stagnation. The minimal revenue growth to nearly $15B fails to generate any meaningful shareholder returns, with the implied share price remaining largely flat around the ~$20 mark. This indicates a business that has hit a strategic ceiling, unable to drive the incremental sales and profit necessary to justify its valuation. The flat EPS projection suggests that both key growth levers—same-store sales and new unit economics—have become ineffective, leading to a period of capital inefficiency where investment no longer yields acceptable returns.</p>
                                <ul class="list-disc list-inside space-y-2 pl-2">
                                    <li>Decelerating comparable sales and weakening new store returns are the primary drivers in this model, signaling potential market saturation or a decline in brand relevance.</li>
                                    <li>The stagnant EPS and implied halt in accretive share repurchases indicate that it is a severe valuation de-rating which means the company can no longer efficiently compound shareholder value, breaking the investment thesis.</li>
                                </ul>
                            </div>`
                     },
                     base: { 
                        imgSrc: portfolioData.imageUrls.chipotleForecastBase,
                        alt:'Forecast — Net revenue (Base scenario), 2025–2028.',
                        interpHTML: `
                            <h3 class="font-bold text-lg mb-2">Base Case — The Execution Baseline: Steady Growth Supporting Fundamental Value</h3>
                            <div class="text-sm text-gray-600 leading-relaxed justified-text space-y-3">
                                <p>This projection outlines a more tempered, yet still positive, future, reflecting a normalization of the company's high-growth phase. While revenue continues to build to ~$16B, the corresponding valuation growth to ~$51 is more modest. This suggests a scenario where the market rewards consistent operational delivery but does not award a significant expansion of the valuation multiple. The strategic narrative shifts from one of explosive growth to one of disciplined execution and margin preservation in a more challenging macroeconomic environment.</p>
                                <ul class="list-disc list-inside space-y-2 pl-2">
                                    <li>The model assumes the company successfully navigates a landscape where driving high-percentage comp growth becomes more difficult, placing greater emphasis on operational efficiency to protect profitability.</li>
                                    <li>The valuation growth is primarily a function of the company "growing into" its multiple through solid EPS expansion to $1.7, rather than the market pricing in an accelerating growth story.</li>
                                </ul>
                            </div>`
                     },
                     bull: { 
                        imgSrc: portfolioData.imageUrls.chipotleForecastBull,
                        alt:'Forecast — Net revenue (Bull scenario), 2025–2028.',
                        interpHTML: `
                            <h3 class="font-bold text-lg mb-2">Bull Case Forecast: Revenue-driven value creation</h3>
                            <div class="text-sm text-gray-600 leading-relaxed justified-text space-y-3">
                                <p>Chipotle’s forecast points to a strong, steady expansion of its topline, with revenues climbing toward the $17–18B range over the projection horizon. This trajectory highlights the company’s ability to sustain growth while maintaining brand strength and consumer loyalty, a key driver in scaling consistently. The graph captures not just expansion, but predictability — a signal that growth is anchored in fundamentals.</p>
                                <ul class="list-disc list-inside space-y-2 pl-2">
                                    <li>The implied share price rises in tandem, reaching close to $72, suggesting that valuation upside is being driven primarily by operational delivery rather than speculative multiple expansion. Investors are effectively rewarding Chipotle’s ability to convert sales momentum into shareholder returns.</li>
                                    <li>The closeness of the revenue and price curves underscores executional alignment: predictable sales growth translates into proportionate investor confidence. This points to a business model where scale is compounding value without significant reliance on external factors.</li>
                                    <li>Margin strength, combined with an accretive share repurchase program that drives EPS from $1.5 to $2.0, justifies the premium valuation forecast.</li>
                                </ul>
                            </div>`
                     }
                };

                toggles.forEach(toggle => {
                    toggle.addEventListener('click', () => {
                        const view = toggle.dataset.view;
                        
                        toggles.forEach(t => t.setAttribute('aria-pressed', 'false'));
                        toggle.setAttribute('aria-pressed', 'true');
                        
                        chartImg.style.opacity = 0;
                        interpContainer.style.opacity = 0;
                        setTimeout(() => {
                            chartImg.src = viewData[view].imgSrc;
                            chartImg.alt = viewData[view].alt;
                            interpContainer.innerHTML = viewData[view].interpHTML;
                            chartImg.style.opacity = 1;
                            interpContainer.style.opacity = 1;
                        }, 300);
                    });
                });
                // Set initial state
                if(toggles.length > 0) {
                    const baseCaseButton = Array.from(toggles).find(t => t.dataset.view === 'base');
                    if(baseCaseButton) baseCaseButton.click();
                }
            }


            const showPage = (pageId) => {
                document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
                const newPage = document.getElementById(`page-${pageId}`);
                if (newPage) {
                    newPage.classList.add('active');
                    if (pageId === 'projects') {
                        setTimeout(() => {
                            setupProjectPage();
                        }, 50);
                    }
                }
                
                document.querySelectorAll('.nav-link').forEach(link => {
                    link.classList.remove('active');
                    if (link.dataset.pageId === pageId) {
                        link.classList.add('active');
                        link.scrollIntoView({ behavior: 'smooth', inline: 'center', block: 'nearest' });
                    }
                });

                sessionStorage.setItem('activePage', pageId);

                if (pageId !== 'home') {
                    window.scrollTo(0, 0);
                }
                handleScrollAnimations(); 
            };

            portfolioData.pages.forEach(page => {
                const link = document.createElement('a');
                link.className = 'nav-link';
                if (page.id === 'home') link.classList.add('active');
                link.textContent = page.label;
                link.dataset.pageId = page.id;
                link.onclick = () => showPage(page.id);
                navContainer.appendChild(link);
            });
            
            const createHomePage = () => {
                const page = document.createElement('div');
                page.id = 'page-home';
                page.className = 'page active';

                const parallaxBanners = [
                    { 
                        id: 'experience', 
                        title: 'Work Experience', 
                        description: 'Hands-on experience across management and financial analysis roles, developing expertise through progressive responsibilities and real-world problem-solving.',
                        bg: 'https://images.unsplash.com/photo-1554224155-6726b3ff858f?q=80&w=1920&auto=format&fit=crop',
                        buttonPageId: 'experience'
                    },
                    { 
                        id: 'education', 
                        title: 'Academic Background', 
                        description: 'A strong academic foundation with an MBA in Finance and a Bachelor\'s in Technology, providing a robust blend of quantitative and strategic expertise.',
                        bg: 'https://images.unsplash.com/photo-1456513080510-7bf3a84b82f8?q=80&w=1920&auto=format&fit=crop',
                        buttonPageId: 'education'
                    },
                    { 
                        id: 'projects', 
                        title: 'Key Projects', 
                        description: 'Real-time financial modeling and valuation projects, including Chipotle Mexican Grill FMVA® analysis. Transforming theory into practical, data-driven insights.',
                        bg: 'https://images.unsplash.com/photo-1639322537228-f710d846310a?q=80&w=1920&auto=format&fit=crop',
                        buttonPageId: 'projects'
                    },
                    { 
                        id: 'resume', 
                        title: 'Resume', 
                        description: 'Certified in financial modeling and valuation, continuously upskilling in finance. Explore my resume to see detailed experience and qualifications.',
                        bg: 'https://images.unsplash.com/photo-1586281380349-632531db7ed4?q=80&w=1920&auto-format&fit=crop',
                        buttonPageId: 'resume'
                    }
                ];

                const parallaxBannersHTML = parallaxBanners.map(section => `
                    <div class="parallax-banner" style="background-image: url('${section.bg}')">
                        <div class="parallax-overlay"></div>
                        <div class="parallax-content p-8">
                            <h2 class="text-3xl md:text-4xl font-bold mb-4">${section.title}</h2>
                            <div class="max-w-2xl mx-auto mb-6 text-base md:text-lg justified-text">
                                <p>${section.description}</p>
                            </div>
                            <button onclick="document.getElementById('main-nav').querySelector('[data-page-id=${section.buttonPageId}]').click()" class="explore-btn font-bold py-3 px-6 rounded-lg transition-all duration-300 inline-flex items-center gap-2" aria-label="Explore ${section.title}">
                                Explore <i class="fas fa-arrow-right"></i>
                            </button>
                        </div>
                    </div>
                `).join('');


                page.innerHTML = `
                    <div class="min-h-screen flex flex-col relative">
                        <section class="flex-grow flex items-center pt-40 pb-16">
                            <div class="container mx-auto px-6">
                               <div class="grid md:grid-cols-10 gap-8 items-center">
                                    <div class="md:col-span-3 flex justify-center md:justify-end">
                                        <div id="profile-image-container" class="relative profile-image-placeholder w-40 h-40 md:w-56 md:h-56">
                                            <!-- SECTION 1: Eager load for above-the-fold image -->
                                            <img id="profile-image" src="${portfolioData.imageUrls.profile}" alt="Bala Sravani Konakalla" class="rounded-full w-full h-full object-cover border-4 border-white/50" loading="eager" onerror="this.onerror=null;this.src='https://placehold.co/224x224/F5F1EA/9C8FA7?text=Image+Not+Found';">
                                        </div>
                                    </div>
                                    <div class="md:col-span-7 text-center md:text-left">
                                        <h1 class="text-4xl md:text-6xl font-bold mb-4 tracking-tight" style="color: #221C2A;">${portfolioData.home.name}</h1>
                                        <p class="text-sm md:text-base max-w-2xl md:mx-0 justified-text" style="color: #463863;">${portfolioData.home.about}</p>
                                    </div>
                                </div>
                            </div>
                        </section>
                        <section class="pb-16 md:pb-24">
                            <div class="container mx-auto px-6">
                               <div class="profile-summary-box max-w-4xl mx-auto bg-white/70 backdrop-blur-sm p-6 rounded-xl shadow-lg border border-gray-200">
                                    <h3 class="text-2xl md:text-3xl font-bold mb-4 text-center" style="color: #221C2A;">Profile Summary</h3>
                                    <p class="text-sm justified-text" style="color: #463863; line-height: 1.8;">${portfolioData.home.summary}</p>
                               </div>
                            </div>
                        </section>
                    </div>
                    
                    <div class="relative z-10">
                        ${parallaxBannersHTML}
                    </div>
                `;
                mainContainer.appendChild(page);
            };

            // const createExperiencePage = () => { ... };
            (function createExperiencePage() {
                const page = document.createElement('div');
                page.id = 'page-experience';
                page.className = 'page';

                const experiencesHTML = portfolioData.experiences.map((exp, index) => {
                    const dutiesHTML = exp.duties.map(duty => `<li class="mb-2">${duty}</li>`).join('');
                    const domainHTML = exp.domain.map(d => `<li class="mb-2">${d}</li>`).join('');

                    return {
                        id: index,
                        ...exp,
                        html: {
                            explorerListItem: `
                                <button class="exp-role-explorer-list-item text-left p-4 rounded-lg w-full ${index === 0 ? 'active' : ''}" data-id="${index}">
                                    <div class="flex items-center gap-3">
                                        <div class="logo-holder !w-10 !h-10">
                                            <!-- SECTION 1: Lazy load images -->
                                            <img src="${portfolioData.imageUrls[exp.logoUrlKey]}" alt="${exp.company} Logo" loading="lazy">
                                        </div>
                                        <div>
                                            <h4 class="font-bold text-sm">${exp.title}</h4>
                                            <p class="text-xs text-gray-500">${exp.company}</p>
                                        </div>
                                    </div>
                                </button>`,
                            explorerContent: `
                                <div class="flex-grow">
                                    <div class="flex flex-col sm:flex-row sm:justify-between sm:items-start mb-2">
                                        <h3 class="text-xl font-bold mb-1 sm:mb-0">${exp.title}</h3>
                                        <p class="text-sm font-medium sm:mt-1 sm:flex-shrink-0 sm:ml-4 order-3 sm:order-2" style="color: #D1A46E;">${exp.date}</p>
                                        <p class="font-semibold mb-0 sm:mb-4 order-2 sm:hidden" style="color: #463863;">${exp.companyFull}</p>
                                    </div>
                                    <p class="font-semibold mb-4 hidden sm:block" style="color: #463863;">${exp.companyFull}</p>
                                    <h4 class="font-bold mb-2" style="color: #D1A46E;">Core Responsibilities:</h4>
                                    <ul class="list-disc pl-5 space-y-1 mb-4">${dutiesHTML}</ul>
                                    <h4 class="font-bold mb-2" style="color: #D1A46E;">Competencies:</h4>
                                    <ul class="list-disc pl-5 space-y-1">${domainHTML}</ul>
                                </div>`,
                        }
                    };
                });
                
                const strategicCapabilities = [
                    { name: 'Financial Modeling & Valuation', icon: 'fas fa-calculator' },
                    { name: 'Scenario Analysis', icon: 'fas fa-sitemap' },
                    { name: 'Advanced Excel & Tableau', icon: 'fas fa-chart-line' },
                    { name: 'S&P Capital IQ', icon: 'fas fa-search-dollar' },
                    { name: 'SAP BPC', icon: 'fas fa-cogs' },
                    { name: 'Data Integrity & Validation', icon: 'fas fa-check-double' },
                    { name: 'Vibe Coding', icon: 'fas fa-code' },
                    { name: 'Power BI & Automation', icon: 'fas fa-robot' }
                ];

                const skillsMatrixHTML = strategicCapabilities.map(skill => `
                    <div class="skill-matrix-item">
                        <div class="skill-logo-holder !w-12 !h-12">
                            <i class="${skill.icon} text-2xl" style="color: #463863;"></i>
                        </div>
                        <h4>${skill.name}</h4>
                    </div>
                `).join('');


                page.innerHTML = `
                    <section class="pt-28 pb-16">
                        <div class="container mx-auto px-6">
                            <h2 class="text-3xl md:text-4xl font-bold text-center mb-4" style="color: #221C2A;">Work Experience</h2>
                            <p class="text-center max-w-3xl mx-auto mb-12" style="color: #9C8FA7;">A detailed overview of my professional roles and responsibilities. Use the interactive menu on the left to switch between positions.</p>
                            <div class="bg-white/50 p-4 rounded-lg shadow-inner">
                                <div class="grid md:grid-cols-12 gap-6">
                                    <div class="md:col-span-4 lg:col-span-3">
                                        <div class="exp-role-explorer-list space-y-2">
                                            ${experiencesHTML.map(exp => exp.html.explorerListItem).join('')}
                                        </div>
                                    </div>
                                    <div class="md:col-span-8 lg:col-span-9 bg-white p-6 rounded-lg shadow-md card-effect">
                                        <div id="exp-role-explorer-content">${experiencesHTML[0].html.explorerContent}</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="text-center mt-20">
                                <h3 class="text-3xl md:text-4xl font-bold text-center mb-12" style="color: #221C2A;">Strategic Capabilities</h3>
                                
                                <div class="skills-matrix-container max-w-5xl mx-auto">
                                    <div class="grid grid-cols-2 sm:grid-cols-4 gap-6">
                                        ${skillsMatrixHTML}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                `;
                mainContainer.appendChild(page);
            })();

            const createEducationPage = () => {
                const page = document.createElement('div');
                page.id = 'page-education';
                page.className = 'page';

                const educationCardsHTML = portfolioData.educations.map(edu => `
                    <div class="education-card bg-white rounded-2xl flex overflow-hidden w-full max-w-2xl mx-auto">
                        <div class="logo-holder !w-24 md:!w-32">
                            <!-- SECTION 1: Lazy load images -->
                            <img src="${portfolioData.imageUrls[edu.logoUrlKey]}" alt="${edu.school} Logo" loading="lazy" onerror="this.src='https://placehold.co/120x120/FFFFFF/463863?text=Logo'; this.parentElement.style.boxShadow='none';">
                        </div>
                        <div class="p-4 md:p-6 md:pl-8 relative flex-grow">
                            <h4 class="text-xl font-bold" style="color: #221C2A;">${edu.degree}</h4>
                            <p class="font-semibold text-md mb-1" style="color: #463863;">${edu.specialization}</p>
                            <p class="text-sm" style="color: #9C8FA7;">${edu.school}, ${edu.location}</p>
                            <p class="text-sm font-medium" style="color: #D1A46E;">${edu.date}</p>
                            <div class="absolute bottom-4 right-4 md:bottom-6 md:right-6">
                                <span class="cgpa-badge">${edu.details}</span>
                            </div>
                        </div>
                    </div>
                `).join('');

                const certificationCardsHTML = portfolioData.certifications.map(cert => `
                    <div class="certification-card bg-white rounded-2xl flex overflow-hidden w-full max-w-3xl mx-auto">
                        <div class="logo-holder !w-24 md:!w-32">
                             <!-- SECTION 1: Lazy load images -->
                             <img src="${portfolioData.imageUrls[cert.logoUrlKey]}" alt="${cert.issuer} Logo" loading="lazy" onerror="this.src='https://placehold.co/120x120/FFFFFF/463863?text=Logo'; this.parentElement.style.boxShadow='none';">
                        </div>
                        <div class="p-4 md:p-6 flex-grow flex flex-col sm:flex-row justify-between items-start sm:items-center relative">
                            <div class="mb-4 sm:mb-0">
                                <h4 class="text-lg font-bold" style="color: #221C2A;">${cert.title}</h4>
                                <p class="font-semibold text-sm mb-1" style="color: #463863;">${cert.issuer}</p>
                                <p class="text-xs font-medium" style="color: #D1A46E;">Issued: ${cert.issueDate}</p>
                            </div>
                            <button class="view-cert-btn cert-view-btn flex-shrink-0 absolute bottom-4 right-4 sm:relative sm:bottom-auto sm:right-auto"
                                    data-img-src="${portfolioData.imageUrls[cert.imageUrlKey]}" 
                                    aria-label="View ${cert.title} certificate">
                                <i class="fas fa-plus"></i>
                            </button>
                        </div>
                    </div>
                `).join('');


                page.innerHTML = `
                    <section class="pt-28 pb-16">
                        <div class="container mx-auto px-6">
                            <h3 class="text-3xl md:text-4xl font-bold text-center mb-12" style="color: #221C2A;">Academic Background</h3>
                            <div class="space-y-8">
                                ${educationCardsHTML}
                            </div>
                            
                            <div class="cert-section mt-20">
                                <h3 class="text-3xl md:text-4xl font-bold text-center mb-12" style="color: #221C2A;">Certifications</h3>
                                <div class="max-w-4xl mx-auto space-y-8">
                                    ${certificationCardsHTML}
                                </div>
                            </div>
                        </div>
                    </section>
                    `;
                mainContainer.appendChild(page);
            };

            const createResumePage = () => {
                const page = document.createElement('div');
                page.id = 'page-resume';
                page.className = 'page';

                page.innerHTML = `
                    <section class="pt-28 pb-16 min-h-[90vh] flex items-center">
                        <div class="container mx-auto px-4 text-center max-w-4xl">
                            <h2 class="text-3xl md:text-4xl font-bold mb-6" style="color: #221C2A;">Resume</h2>
                            
                            <div class="bg-white rounded-2xl shadow-lg p-2 md:p-4 mb-2">
                                <!-- SECTION 1: Lazy load images -->
                                <img src="${portfolioData.imageUrls.resumePreview}" 
                                     alt="Preview of Bala Sravani Konakalla’s Resume" 
                                     class="w-full h-auto rounded-lg mx-auto cursor-pointer hover:opacity-90 transition-opacity" 
                                     loading="lazy"
                                     onclick="openLightbox(this.src)">
                            </div>
                            <p id="resume-last-updated" class="text-sm text-gray-500 text-right italic mb-8"></p>

                            <div class="flex flex-col sm:flex-row items-center justify-center gap-4">
                                 <a href="./Bala Sravani Konakalla.pdf" download="Bala_Sravani_Konakalla_Resume.pdf" class="btn-primary w-full sm:w-auto font-bold py-3 px-6 rounded-lg transition-all duration-300 inline-flex items-center justify-center gap-2" aria-label="Download Resume PDF">
                                    <i class="fas fa-download"></i> Download PDF
                                </a>
                                <a href="https://linkedin.com/in/kbalasravani" target="_blank" class="btn-secondary w-full sm:w-auto font-bold py-3 px-6 rounded-lg transition-all duration-300 inline-flex items-center justify-center gap-2" aria-label="View on LinkedIn">
                                    <i class="fab fa-linkedin"></i> View on LinkedIn
                                </a>
                            </div>
                        </div>
                    </section>
                `;
                mainContainer.appendChild(page);

                // Set last updated date
                const lastUpdatedEl = page.querySelector('#resume-last-updated');
                if (lastUpdatedEl) {
                    const today = new Date();
                    const dayOfWeek = today.getDay(); // Sunday = 0, Monday = 1, etc.
                    const lastSunday = new Date(today.setDate(today.getDate() - dayOfWeek));
                    const formattedDate = lastSunday.toLocaleDateString('en-US', {
                        month: 'long',
                        day: 'numeric',
                        year: 'numeric'
                    });
                    lastUpdatedEl.textContent = `Last updated on ${formattedDate}`;
                }
            };
            
            const createProjectsPage = () => {
                const page = document.createElement('div');
                page.id = 'page-projects';
                page.className = 'page';

                page.innerHTML = `
                <!-- 1. Project Header Section -->
                <div id="project-header" class="project-section-fade-in relative overflow-hidden pt-40 pb-16">
                    <div class="absolute inset-0 z-0">
                        <svg class="absolute bottom-0 right-0 h-1/2 w-1/2 text-gray-500 opacity-[0.03]" fill="currentColor" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><path d="M512 597.995c-113.003 0-204.8-91.797-204.8-204.8s91.797-204.8 204.8-204.8 204.8 91.797 204.8 204.8-91.797 204.8-204.8 204.8zM512 256c-79.508 0-144.37 64.862-144.37 144.37s64.862 144.37 144.37 144.37 144.37-64.862 144.37-144.37-64.862-144.37-144.37-144.37z"/><path d="M512 1024c-282.77 0-512-229.23-512-512s229.23-512 512-512 512 229.23 512 512-229.23 512-512 512zM512 61.44C264.604 61.44 61.44 264.604 61.44 512s203.164 450.56 450.56 450.56 450.56-203.164 450.56-450.56-203.164-450.56-450.56-450.56z"/><path d="M961.075 613.99c-30.822-1.946-59.597-10.138-85.3-23.757l-2.048-1.229c-10.138-6.042-19.866-12.7-28.979-20.07-8.806-6.963-16.896-14.541-24.166-22.733-1.434-1.638-2.867-3.277-4.301-4.915-28.365-32.358-49.152-70.554-59.802-112.947-3.277-13.005-5.325-26.317-6.554-39.834-0.614-10.138-0.614-20.378-0.205-30.515 1.536-25.805 6.758-50.995 15.36-74.957 14.848-41.472 40.55-78.131 74.547-107.008 33.382-28.365 73.626-47.309 117.555-55.296 5.837-1.024 11.674-1.843 17.613-2.458 35.84-3.79 72.192-0.307 106.803 10.138 34.099 10.24 65.638 27.238 93.39 49.971 2.867 2.355 5.632 4.813 8.397 7.27 34.816 30.618 60.006 70.144 72.909 114.176 15.36 52.634 15.053 108.954-0.819 161.792-12.902 43.11-37.376 81.92-69.837 114.176-32.051 31.846-70.963 56.525-114.074 71.373-35.635 12.288-73.421 18.227-111.821 17.408-10.138-0.205-20.275-0.819-30.31-1.843z"/></svg>
                    </div>
                    <div class="container mx-auto max-w-screen-xl px-6 md:px-8 relative z-10">
                        <div class="grid md:grid-cols-12 gap-x-4 items-center text-center md:text-left">
                             <div class="md:col-span-2 flex justify-center md:justify-end">
                                <div class="w-28 h-28 md:w-32 md:h-32 bg-white rounded-full chipotle-logo-glow flex items-center justify-center flex-shrink-0 overflow-hidden">
                                    <!-- SECTION 1: Lazy load images -->
                                    <img src="${portfolioData.imageUrls.logoChipotle}" alt="Chipotle Company Logo" class="w-full h-full object-cover" loading="lazy" onerror="this.src='https://placehold.co/128x128/FFFFFF/AD2F1F?text=CMG'">
                                </div>
                            </div>
                            <div class="md:col-span-10">
                                <h1 class="text-3xl md:text-4xl font-extrabold leading-tight">Chipotle Mexican Grill, Inc. (NYSE: CMG)</h1>
                                <h2 class="text-xl md:text-2xl font-semibold mt-2" style="color: #AD2F1F;">Financial Modeling & Multi-Scenario Forecasting</h2>
                            </div>
                        </div>

                        <div class="w-full border-t border-gray-300/60 my-8 md:my-12"></div>
                        
                        <div class="max-w-6xl mx-auto space-y-8">
                            <div class="project-card bg-white/70 backdrop-blur-sm p-6 rounded-xl shadow-lg border border-gray-200 text-left">
                                <h3 class="font-bold text-lg mb-2">About the Company</h3>
                                <p class="text-sm leading-relaxed mb-4 justified-text">
                                    Chipotle Mexican Grill is a company-owned fast-casual restaurant chain built around customizable burritos and bowls. As of 2024 it operates roughly 3,700+ restaurants and has scaled its Chipotlane drive-thru format to meet rising digital demand. The brand’s “Food With Integrity” sourcing, a streamlined menu, and centralized operations support consistent unit economics and quality control. Primary growth drivers are disciplined unit expansion, Chipotlane penetration, digital ordering & loyalty, and menu innovation — all backed by tight cost control that has driven margin expansion. Together, these factors position Chipotle to convert new store growth and higher digital penetration into durable, higher-quality earnings.
                                </p>
                                <div class="grid grid-cols-2 sm:grid-cols-4 gap-4 text-center pt-4 border-t border-gray-200">
                                    <div><p class="font-bold">Analysis</p><p class="text-xs">Sep 2025</p></div>
                                    <div><p class="font-bold">Historical</p><p class="text-xs">2021 - 2024</p></div>
                                    <div><p class="font-bold">Forecast</p><p class="text-xs">2025 - 2028</p></div>
                                    <div><p class="font-bold">Sources</p><p class="text-xs">10-K Filings</p></div>
                                </div>
                            </div>
                             <div class="project-card bg-white/70 backdrop-blur-sm p-6 rounded-xl shadow-lg border border-gray-200 text-left">
                                <h3 class="font-bold text-lg mb-2">About the Project</h3>
                                <p class="text-sm leading-relaxed mb-4 justified-text">
                                   Leveraging a comprehensive financial modeling skill set, this project delivers a detailed assessment of Chipotle's financial performance and a forward-looking valuation through FY28. The core of the analysis deconstructs revenue growth into its primary drivers of store expansion and same-store sales, and then traces the impact through margin evolution down to earnings per share. To quantify a range of potential outcomes, the model utilizes Bull, Base, and Bear scenarios to test how Chipotle's intrinsic value responds to shifts in key business assumptions. More than just a final number, this analysis provides a strategic framework for evaluating how operational decisions translate into financial returns.
                                </p>
                                <div class="flex flex-wrap justify-start gap-2 pt-4 border-t border-gray-200">
                                     <span class="bg-blue-100 text-blue-800 text-xs font-semibold px-3 py-1 rounded-full">Scenario Analysis</span>
                                     <span class="bg-green-100 text-green-800 text-xs font-semibold px-3 py-1 rounded-full">Forecasting</span>
                                     <span class="bg-yellow-100 text-yellow-800 text-xs font-semibold px-3 py-1 rounded-full">Financial Modeling</span>
                                     <span class="bg-purple-100 text-purple-800 text-xs font-semibold px-3 py-1 rounded-full">Valuation Analysis</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Historical Analysis Section -->
                <section class="historical-analysis-section py-12 md:py-16 bg-white/50 project-section-fade-in">
                     <div class="container mx-auto max-w-screen-xl px-6 md:px-8">
                        <div class="text-center mb-8">
                             <h2 class="text-3xl md:text-4xl font-bold">Historical Analysis</h2>
                        </div>
                        
                        <div class="grid md:grid-cols-12 gap-6 md:gap-8 items-center">
                            <!-- Chart -->
                            <div class="md:col-span-7">
                                <div class="scenario-selector flex justify-center items-center gap-4 mb-6">
                                    <button class="mini-card-toggle text-left p-3 rounded-lg w-40" data-view="financials" aria-pressed="true">
                                        <h4 class="font-bold text-sm">Financials</h4>
                                        <p class="text-xs text-gray-500">Revenue & Profit</p>
                                    </button>
                                    <button class="mini-card-toggle text-left p-3 rounded-lg w-40" data-view="stores" aria-pressed="false">
                                        <h4 class="font-bold text-sm">Stores vs SSS</h4>
                                        <p class="text-xs text-gray-500">Units & Comps</p>
                                    </button>
                                </div>
                                <div class="chart-frame project-card">
                                    <!-- SECTION 1: Lazy load images -->
                                    <img id="historical-analysis-img" src="${portfolioData.imageUrls.chipotleHistFinancials}" width="1280" height="720" loading="lazy" alt="Historical financials: Revenue and Net Income, 2018–2024.">
                                </div>
                            </div>
                            <!-- Interpretation -->
                            <div id="historical-analysis-interp" class="md:col-span-5 transition-opacity duration-300 project-card p-4 rounded-lg">
                                <!-- Content will be injected by JS -->
                            </div>
                        </div>
                    </div>
                </section>
                
                 <!-- Forecast Section -->
                <section class="chipotle-forecast-section py-12 md:py-16 project-section-fade-in">
                     <div class="container mx-auto max-w-screen-xl px-6 md:px-8">
                        <div class="text-center mb-12">
                             <h2 class="text-3xl md:text-4xl font-bold">Forecast Scenarios — Bull / Base / Bear (2025–2028)</h2>
                        </div>
                        
                        <div class="grid md:grid-cols-12 gap-6 md:gap-8 items-center">
                            <!-- Chart -->
                            <div class="md:col-span-7">
                                <div class="scenario-selector flex flex-wrap justify-center items-center gap-4 mb-6">
                                    <button class="mini-card-toggle text-left p-3 rounded-lg w-40" data-view="bull" aria-pressed="false">
                                        <h4 class="font-bold text-sm">Bull Case</h4>
                                        <p class="text-xs text-gray-500">Upside Scenario</p>
                                    </button>
                                    <button class="mini-card-toggle text-left p-3 rounded-lg w-40" data-view="base" aria-pressed="true">
                                        <h4 class="font-bold text-sm">Base Case</h4>
                                        <p class="text-xs text-gray-500">Central Scenario</p>
                                    </button>
                                    <button class="mini-card-toggle text-left p-3 rounded-lg w-40" data-view="bear" aria-pressed="false">
                                        <h4 class="font-bold text-sm">Bear Case</h4>
                                        <p class="text-xs text-gray-500">Downside Scenario</p>
                                    </button>
                                </div>
                                <div class="chart-frame project-card">
                                    <!-- SECTION 1: Lazy load images -->
                                    <img id="forecast-analysis-img" src="${portfolioData.imageUrls.chipotleForecastBase}" width="1280" height="720" loading="lazy" alt="Forecast — Net revenue (Base scenario), 2025–2028.">
                                </div>
                            </div>
                            <!-- Interpretation -->
                            <div id="forecast-analysis-interp" class="md:col-span-5 transition-opacity duration-300 project-card p-4 rounded-lg">
                               <!-- Content will be injected by JS -->
                            </div>
                        </div>
                    </div>
                </section>

                 <!-- 5. Investment Thesis Section -->
                <section id="investment-thesis" class="py-12 md:py-20 project-section-fade-in">
                    <div class="container mx-auto max-w-screen-xl px-6 md:px-8">
                        <div class="bg-white/70 backdrop-blur-sm p-8 rounded-xl shadow-lg border border-gray-200 project-card">
                             <h2 class="text-3xl font-bold mb-8 text-center">Chipotle’s Next Chapter: Sustaining Strength While Expanding Scale</h2>
                            <div class="grid md:grid-cols-12 gap-8 items-center">
                                <div class="md:col-span-4">
                                    <div class="p-6 bg-gray-100 rounded-lg flex items-center justify-center">
                                        <svg class="w-full h-auto max-w-[200px] text-[#463863]" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                            <path d="M4 4h4v16H4V4zm6 6h4v10h-4V10zm6-4h4v14h-4V6z" fill-opacity="0.3"/>
                                            <path d="M5 20V7h2v13H5zm6-10v10h2V10h-2zm6-3v13h2V7h-2z"/>
                                            <path d="M2.5 19.5h19v2h-19v-2z"/>
                                            <path d="M17 5l-4.5 4.5-2.5-2.5L3 14" stroke="#D1A46E" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
                                            <path d="M13 5h4v4" stroke="#D1A46E" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
                                        </svg>
                                    </div>
                                </div>
                                <div class="md:col-span-8">
                                    <div class="text-gray-600 leading-relaxed justified-text space-y-4">
                                        <p>Chipotle’s trajectory now hinges less on rebound-fueled growth and more on operational discipline to preserve unit economics as it scales aggressively. With post-pandemic comps normalizing, the spotlight shifts to expanding margins through automation, throughput optimization, and Chipotlane penetration. Execution risk is rising as the company balances domestic expansion with its first major international push, all while navigating inflation, wage pressures, and shifting consumer habits.</p>
                                        <p>Menu innovation and digital engagement continue to drive brand loyalty, testing whether Chipotle can replicate its U.S. playbook globally without eroding its premium positioning.</p>
                                        <p>The company’s valuation assumes continued outperformance — making consistent delivery, not expansion alone, the key to shareholder value.</p>
                                        <p>Investors will watch closely how leadership executes under mounting complexity, as Chipotle enters a more mature — and scrutiny-heavy — phase of growth. Overall, Chipotle’s next phase emphasizes disciplined execution as the cornerstone of sustainable shareholder value.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
                
                <section class="py-12 project-section-fade-in">
                    <div class="container mx-auto px-6 md:px-8 text-center">
                        <a href="#" aria-label="Download Financial Model" class="btn-primary font-bold py-3 px-8 rounded-lg inline-flex items-center gap-2">
                            <i class="fas fa-download"></i> Download Financial Model
                        </a>
                    </div>
                </section>
                `;
                mainContainer.appendChild(page);
            };
            
            // --- INITIALIZE ALL PAGES ---
            createHomePage();
            // FIX: Commented out this call. The function is now an IIFE and executes itself.
            // createExperiencePage(); 
            createProjectsPage();
            createEducationPage();
            createResumePage();

            // --- GLOBAL LOGIC & EVENT LISTENERS ---
            document.getElementById('copyright-year').textContent = new Date().getFullYear();

            // Event Delegation for Experience Tab
            mainContainer.addEventListener('click', (e) => {
                const roleExplorerButton = e.target.closest('.exp-role-explorer-list-item');
                if (roleExplorerButton) {
                    const explorerList = roleExplorerButton.closest('.exp-role-explorer-list');
                    const explorerContent = document.getElementById('exp-role-explorer-content');
                    if (!explorerList || !explorerContent) return;

                    explorerList.querySelectorAll('button').forEach(btn => btn.classList.remove('active'));
                    roleExplorerButton.classList.add('active');
                    
                    const expId = parseInt(roleExplorerButton.dataset.id);
                    const exp = portfolioData.experiences[expId]; 

                    if (exp) { 
                        const dutiesHTML = exp.duties.map(duty => `<li class="mb-2">${duty}</li>`).join(''); 
                        const domainHTML = exp.domain.map(d => `<li class="mb-2">${d}</li>`).join(''); 

                        explorerContent.style.opacity = 0;
                        setTimeout(() => {
                            explorerContent.innerHTML = `
                                <div class="flex-grow">
                                    <div class="flex flex-col sm:flex-row sm:justify-between sm:items-start mb-2">
                                        <h3 class="text-xl font-bold mb-1 sm:mb-0">${exp.title}</h3>
                                        <p class="text-sm font-medium sm:mt-1 sm:flex-shrink-0 sm:ml-4 order-3 sm:order-2" style="color: #D1A46E;">${exp.date}</p>
                                        <p class="font-semibold mb-0 sm:mb-4 order-2 sm:hidden" style="color: #463863;">${exp.companyFull}</p>
                                    </div>
                                    <p class="font-semibold mb-4 hidden sm:block" style="color: #463863;">${exp.companyFull}</p>
                                    <h4 class="font-bold mb-2" style="color: #D1A46E;">Core Responsibilities:</h4>
                                    <ul class="list-disc pl-5 space-y-1 mb-4">${dutiesHTML}</ul>
                                    <h4 class="font-bold mb-2" style="color: #D1A46E;">Competencies:</h4>
                                    <ul class="list-disc pl-5 space-y-1">${domainHTML}</ul>
                                </div>`;
                            explorerContent.style.opacity = 1;
                        }, 300);
                    } 
                }
            });

            const savedPage = sessionStorage.getItem('activePage');
            if (savedPage) {
                showPage(savedPage);
            } else {
                showPage('home');
            }
            
            const header = document.querySelector('header');
            const progressBar = document.getElementById('progress-bar');
            let lastScrollTop = 0;
            
            window.addEventListener('scroll', function() {
                let scrollTop = window.pageYOffset || document.documentElement.scrollTop;
                
                const isScrollingDown = scrollTop > lastScrollTop;

                header.classList.toggle('nav-hidden', isScrollingDown && scrollTop > header.offsetHeight);
                
                lastScrollTop = scrollTop <= 0 ? 0 : scrollTop;

                const scrollHeight = document.documentElement.scrollHeight - document.documentElement.clientHeight;
                const scrollPercent = scrollHeight > 0 ? (scrollTop / scrollHeight) * 100 : 0;
                if (progressBar) {
                    progressBar.style.width = scrollPercent + '%';
                }

                const parallaxBanners = document.querySelectorAll('.parallax-banner');
                parallaxBanners.forEach(banner => {
                    const rect = banner.getBoundingClientRect();
                    if (rect.top < window.innerHeight && rect.bottom >= 0) {
                        banner.classList.add('visible');
                    }
                });
                handleScrollAnimations();
            }, false);

            const educationCards = document.querySelectorAll('.education-card, .certification-card');
            if (educationCards.length > 0) {
                const eduObserver = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) entry.target.classList.add('visible');
                    });
                }, { threshold: 0.2 });
                educationCards.forEach(card => eduObserver.observe(card));
            }
            
            const successToast = document.getElementById('success-toast');
            const contactModal = document.getElementById('contact-modal');
            const contactForm = contactModal.querySelector('.contact-form');
            contactForm.action = portfolioData.contact.formspree_url;
            
            contactForm.addEventListener('submit', function(e) {
                e.preventDefault();
                const formData = new FormData(this);
                fetch(this.action, { method: 'POST', body: formData, headers: { 'Accept': 'application/json' } })
                .then(response => { 
                    if (response.ok) { 
                        closeContactModal();
                        setTimeout(() => {
                           successToast.classList.add('show'); 
                            setTimeout(() => successToast.classList.remove('show'), 4000);
                        }, 400);
                        contactForm.reset(); 
                    } else {
                        response.json().then(data => {
                            if (Object.hasOwn(data, 'errors')) {
                                // Re-enable this if you need alerts, but per instructions,
                                // a custom modal would be better. For now, logging to console.
                                console.error("Form errors:", data["errors"]);
                                // alert(data["errors"].map(error => error["message"]).join(", "));
                            } else {
                                console.error("Form submission error.");
                                // alert("There was an error sending your message. Please try again.");
                            }
                        })
                    }
                }).catch(error => {
                    console.error("Form submission error.", error);
                    // alert("There was an error sending your message. Please try again.");
                }); 
            });


            function handleScrollAnimations() {}

            const certSection = document.querySelector('.cert-section');
            if (certSection) {
                certSection.addEventListener('click', (e) => {
                    const triggerButton = e.target.closest('.view-cert-btn');
                    if (triggerButton) {
                        e.preventDefault();
                        const imgSrc = triggerButton.dataset.imgSrc;
                        if (imgSrc) {
                            openLightbox(imgSrc);
                        }
                    }
                });
            }

            const canvas = document.getElementById('finance-canvas');
            const ctx = canvas.getContext('2d');
            let particles = [];
            const symbols = ['$', '%', '▲', '▼', '📈', '📉'];
            const mouse = { x: null, y: null, radius: 180 };

            window.addEventListener('mousemove', (event) => { mouse.x = event.x; mouse.y = event.y; });
            window.addEventListener('mouseout', () => { mouse.x = null; mouse.y = null; });

            function resizeCanvas() {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
            }

            function createParticles() {
                particles = [];
                let numberOfParticles = (canvas.width * canvas.height) / 20000;
                for (let i = 0; i < numberOfParticles; i++) {
                    particles.push({
                        x: Math.random() * canvas.width,
                        y: Math.random() * canvas.height,
                        vx: (Math.random() - 0.5) * 0.3,
                        vy: (Math.random() - 0.5) * 0.3,
                        size: Math.random() * 2 + 10,
                        symbol: symbols[Math.floor(Math.random() * symbols.length)]
                    });
                }
            }

            function connectParticles() {
                for (let a = 0; a < particles.length; a++) {
                    for (let b = a; b < particles.length; b++) {
                        let dx = particles[a].x - particles[b].x;
                        let dy = particles[a].y - particles[b].y;
                        let distance = Math.sqrt(dx * dx + dy * dy);
                        if (distance < 120) {
                            ctx.strokeStyle = 'rgba(209, 164, 110, ' + (1 - distance/120) + ')';
                            ctx.lineWidth = 0.6;
                            ctx.beginPath();
                            ctx.moveTo(particles[a].x, particles[a].y);
                            ctx.lineTo(particles[b].x, particles[b].y);
                            ctx.stroke();
                        }
                    }
                }
            }

            function animate() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                for (let i = 0; i < particles.length; i++) {
                    let p = particles[i];
                    p.x += p.vx; p.y += p.vy;
                    if (p.x < 0 || p.x > canvas.width) p.vx *= -1;
                    if (p.y < 0 || p.y > canvas.height) p.vy *= -1;
                    if (mouse.x && mouse.y) {
                        let dx = mouse.x - p.x;
                        let dy = mouse.y - p.y;
                        let distance = Math.sqrt(dx * dx + dy * dy);
                        if (distance < mouse.radius) { p.x -= dx / 18; p.y -= dy / 18; }
                    }
                    ctx.fillStyle = `rgba(70, 56, 99, 0.5)`;
                    ctx.font = `${p.size}px Montserrat`;
                    ctx.fillText(p.symbol, p.x, p.y);
                }
                connectParticles();
                requestAnimationFrame(animate);
            }

            window.addEventListener('resize', () => { resizeCanvas(); createParticles(); });
            resizeCanvas(); createParticles(); animate();
            
            const lightbox = document.getElementById('lightbox');
            const lightboxClose = document.getElementById('lightbox-close');
            window.openLightbox = function(src) {
                const lightboxImg = document.getElementById('lightbox-img');
                if (lightbox && lightboxImg) {
                    lightboxImg.src = src;
                    lightbox.classList.remove('hidden');
                    lightbox.classList.add('flex');
                }
            }
            function closeLightbox() {
                if (lightbox) {
                    lightbox.classList.add('hidden');
                    lightbox.classList.remove('flex');
                }
            }
            if (lightbox && lightboxClose) {
                lightboxClose.addEventListener('click', closeLightbox);
                lightbox.addEventListener('click', (e) => { if (e.target === lightbox) closeLightbox(); });
            }

            const contactFab = document.getElementById('contact-fab');
            const modalOverlay = contactModal.querySelector('.modal-overlay');
            const modalCloseBtn = document.getElementById('modal-close-btn');

            function openContactModal() {
                 contactModal.classList.remove('hidden');
                 contactModal.classList.add('flex');
                 setTimeout(() => contactModal.classList.add('visible'), 10);
            }
            function closeContactModal() {
                contactModal.classList.remove('visible');
                setTimeout(() => {
                    contactModal.classList.add('hidden');
                    contactModal.classList.remove('flex');
                }, 300);
            }

            if (contactFab) contactFab.addEventListener('click', openContactModal);
            if (modalOverlay) modalOverlay.addEventListener('click', closeContactModal);
            if (modalCloseBtn) modalCloseBtn.addEventListener('click', closeContactModal);

            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    closeLightbox();
                    closeContactModal();
                }
            });

            const fabContent = document.querySelector('#contact-fab .fab-content');
            if (fabContent) {
                fabContent.addEventListener('animationend', () => {
                    fabContent.classList.remove('fab-pulse');
                }, { once: true });
            }
        });
    </script>
</body>
</html>



